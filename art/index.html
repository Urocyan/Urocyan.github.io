<!DOCTYPE html>
<html lang="en">
<head>
  <title>QuickSort</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=no">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/ui-darkness/jquery-ui.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script>
$(document).ready(async function(){
const apiKey = "AIzaSyDvh32i42OPf--3SPxAL3iQHyfmWq-xaX8";

function findFolder(file) {
	return file.mimeType == "application/vnd.google-apps.folder";
}

async function getFiles(driveID) {
	return new Promise((resolve,reject) => {
	$.ajax({
		method:'GET',
		dataType:'JSON',
		url:"https://www.googleapis.com/drive/v2/files?q='"+driveID+"'+in+parents&key="+apiKey,
		success: (data) => {
			resolve(data.items);
		}
	});
	});
}	
var files = await getFiles("17JC04FU0JsbPQnQQoJVNoMGGd3kRBfjD");
console.log(files[1]);
while(files.find(findFolder) != undefined) {
	let folderIndex = files.findIndex(findFolder);
	var addFiles = await getFiles(files[folderIndex].id);
	$.each(addFiles,(i,file) => {
		file.parentFolderName = files[folderIndex].title;
	});
	files.splice(folderIndex,1);
	if(addFiles.length > 0) {
		files = files.concat(addFiles);
	}
}
files = files.filter(file => {return file.mimeType.indexOf("image") > -1;});
var categories = [
{
	name:"Unknown",
	art: []
}
];
$.each(files,(i,file) => {
	var newImg = file.webContentLink;
	newImg = newImg.replace("export=download","export=view");
	//console.log(newImg);
	if(file.parentFolderName) {
		var index = categories.findIndex(category => {return category.name == file.parentFolderName;});
		console.log(index);
		if(index != -1) {
			categories[index].art.push(newImg);
		}
		else {
			categories.push({name:file.parentFolderName,art:[]});
			index = categories.findIndex(category => {return category.name == file.parentFolderName;});
			categories[index].art.push(newImg);
		}
	}
	else {
		categories[0].art.push(newImg);
	}
});
for(let i = 0; i < categories.length; i++) {
	var container = "Unknown";
	if(categories[i].name) {
		container = categories[i].name;
	}
	$("<div>").attr({"class":"well alert alert-info artistTitle","data-toggle":"collapse","data-target":"#"+container}).html("<h2>"+categories[i].name+"</h2>").appendTo("body");
	$("<div>").attr({"class":"container-fluid artBox collapse","id":container}).appendTo("body");
	for(let j = 0; j < categories[i].art.length; j++) {
		$("<a>").attr({"href":categories[i].art[j],"target":"_blank"}).html("<img src='"+categories[i].art[j]+"' class='bodyImg' />").appendTo("#"+container);
	}
}
console.log(categories);
});


</script>
<script
  src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
  integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
  crossorigin="anonymous"></script>
<style>
.artistTitle {
	text-align:center;
}
.jumbotron {
	text-align:center;
}
.artBox {
	text-align: center;
}
.collapse.in.artBox {
	
}
.bodyImg {
	object-fit: scale-down;
	max-width:100%;
	display: inline-block;
	margin-top:5px;
	margin-bottom: 5px;
}
.artBox {
	max-width: 100%;
}
</style>
</head>
<body>
<div class="jumbotron">
	<h1>Rocket Art</h1>
	<p>All art shown is commissioned, not created by me</p>
</div>
</body>
</html>